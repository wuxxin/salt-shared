{%- set gwip = salt['network.default_route']('inet')[0]['gateway'] %}
{%- set gwdev = salt['network.default_route']('inet')[0]['interface'] %}
{%- set address = salt['network.ip_addrs'](gwdev)[0] %}

{% load_yaml as defaults %}
server:
  tag: stable
  name: {{ salt['grains.item']('host') }}
  http_port: 2280
  https_port: 2243
  password: admin
  data: /var/lib/rancher
  cluster: default
agent:
  data: /var/lib/kublet
  address: {{ address }}

{% endload %}

{% load_yaml as extra_example %}
server:
  dns:
    ip:
    search:
  env:
agent:
  dns:
    ip:
    search:
  env:
{% endload %}

{% set settings=salt['grains.filter_by']({'none': defaults},
  grain='none', default= 'none', merge= salt['pillar.get']('rancher', {})) %}
