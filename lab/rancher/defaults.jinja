{%- set gwip = salt['network.default_route']('inet')[0]['gateway'] %}
{%- set gwdev = salt['network.default_route']('inet')[0]['interface'] %}
{%- set address = salt['network.ip_addrs'](gwdev)[0] %}

{% load_yaml as defaults %}
server:
  tag: master
  http_port: 80
  https_port: 443
  ip: {{ address }}
  volume: /var/rancher/server
  cluster:
    - name: default

{% endload %}

{% set settings=salt['grains.filter_by']({'none': defaults},
  grain='none', default= 'none', merge= salt['pillar.get']('rancher', {})) %}
