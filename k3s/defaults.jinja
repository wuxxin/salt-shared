{% set user= 'app' %}
{% set home= '/'+ user %}
{% set gwip= salt['network.default_route']('inet')[0]['gateway'] %}
{% set gwdev= salt['network.default_route']('inet')[0]['interface'] %}

{% load_yaml as defaults %}
k3s_version: 'v1.17.3+k3s1'
rio_version: 'v0.7.0' 
helm_version: 'v3.1.1'
helmfile_version: 'v0.102.0'
user: {{ user }}
home: {{ home }}
route_ip: {{ salt['network.ip_addrs'](gwdev)[0] }}
state_dir: {{ home }}/{{ user }}-k3s-helmfile
{% endload %}

{% set settings=salt['grains.filter_by']({'none': defaults},
  grain='none', default= 'none', merge= salt['pillar.get']('k3s', {})) %}
