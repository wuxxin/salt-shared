# http_frontend

uses nginx as webserver, acme.sh for letsencrypt service, easy-rsa for pki management.


### pillar settings

#### ssl settings
1. use cert+key, if pillar http_frontend.cert + http_frontend.key is set
2. use letsencrypt, if pillar http_frontend.letsencrypt:true and cert could be retrieved
3. use autogenerated selfsigned cert

#### common settings

```yaml
domain: hostname if empty
allowed_hosts: [hostname if empty]
listen_ip:
  - default-route-ip
letsencrypt: default true
client_cert_verify: default false, true will make optional client certificate verification
client_cert_mandatory: default false, true will make mandatory client certificate verification
user: {{ user }}
cert_dir: {{ user_home }}/ssl

upstream: # [] # list of {name, server}
  - name: webhooks
    server: "127.0.0.1:5555"
location:
  - source: /hooks/
    target: proxy_pass http://webhooks
  - source: /
    target: root /var/www/main.domain/
host:
  - domain: another.domain
    client_cert_verify: true
    location:
      - source: /
        target: root /var/www/another.domain/
```
