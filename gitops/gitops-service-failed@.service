[Unit]
Description=Gitops Service Error %I
ConditionFileNotEmpty={{ settings.env_file }}
Wants=network-online.target

[Service]
Type=oneshot
Environment=UNITNAME=%i
EnvironmentFile={{ settings.env_file }}
PassEnvironment=UNITNAME SENTRY_DSN
ExecStart=/bin/bash -c '. /usr/local/lib/gitops-library.sh; \
    sentry_entry "Service Error" "Service ($UNITNAME) failed" \
        error "$(systemd_json_status "$UNITNAME")" "gitops-service-failed"'
